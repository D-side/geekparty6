<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>spr_slime</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>randomize();
with(slime)
    image_blend = make_color_hsv(irandom(255), 255, 200);
arg_ani = random(pi);
arg_gravity = 0.15;
arg_friction = 0.15;
arg_hurt = 0;

offx = 0;
offy = 0;

floory = y;

key_up = vk_up;
key_down = vk_down;
key_left = vk_left;
key_right = vk_right;

collided = false;
hp = 50;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="2">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Экранирование от стен:

if (x &lt; 0) &amp;&amp; (xprevious &gt;= 0)
{
    x = -x;
    hspeed = -hspeed;
}

if (x &gt; room_width) &amp;&amp; (xprevious &lt;= room_width)
{
    x = room_width - (x - room_width);
    hspeed = -hspeed;
}

arg_hurt -= 0.1;

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="1">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>arg_ani += 0.1;

image_xscale = 1 + 0.05 * sin(arg_ani);
image_yscale = 1 - 0.05 * sin(arg_ani);

//Смещение центра тяжести
//0.015 per step + 0.05 drop
if keyboard_check(key_down)
    if (offy &gt; -(1.000 - 0.060))
        offy -= 0.060;
    else
        offy = -1.000;
        
if keyboard_check(key_right)
    if (offx &gt; -(1.000 - 0.060))
        offx -= 0.060;
    else
        offx = -1.000;

if keyboard_check(key_left)
    if (offx &lt; (1.000 - 0.060))
        offx += 0.060;
    else
        offx = +1.000;

if keyboard_check(key_up)
    if (offy &lt; (1.000 - 0.060))
        offy += 0.060;
    else
        offy = +1.000;

        
//Дроп смещения со временем
if (abs(offy) &lt;= 0.020)
    offy = 0.000;
else
    offy += -sign(offy) * 0.020;

if (abs(offx) &lt;= 0.020)
    offx = 0.000;
else
    offx += -sign(offx) * 0.020;

//ЭКШОН
if ( keyboard_check_released(key_up) &amp;&amp; (offy &gt; 0) &amp;&amp; (abs(y - floory) &lt; 1) )
{
    y -= 0.1; //dirty fix
    vspeed = -offy * 12; //Прыжок
    audio_play_sound(snd_jump, 10, false);
    offy = 0;
}

if ( keyboard_check_released(key_down) &amp;&amp; (offy &lt; 0) &amp;&amp; (y &lt; floory) )
{
    vspeed -= offy * 16; //Падение
    audio_play_sound(snd_drop, 10, false);
    offy = 0;
}

if ( keyboard_check_released(key_right) &amp;&amp; (offx &lt; 0) )
{
    hspeed = -offx * 10; //Рывок
    audio_play_sound(snd_dash, 10, false);
    offx = 0;
}

if ( keyboard_check_released(key_left) &amp;&amp; (offx &gt; 0) )
{
    hspeed = -offx * 10; //Удар!
    audio_play_sound(snd_dash, 10, false);
    offx = 0;
}

///Больше действий сюда

//Трение и гравитация
if (abs(hspeed) &lt;= arg_friction)
    hspeed = 0.000;
else
    hspeed += -sign(hspeed) * arg_friction;

if (y &lt; floory)
{
    vspeed += arg_gravity;
}
else
{
    vspeed = 0;
    y = floory;
}

//Нанесение повреждений
opponent = other_slime();

if ( place_meeting(x, y, opponent) &amp;&amp; (!collided) )
{
    //УДАРРР
    if (speed &lt; opponent.speed)
    {
        var damage = opponent.speed - speed;
        audio_play_sound(snd_hurt, 10, false);
        arg_hurt = 1.0;
        if (damage &gt; hp)
            hp = 0;
        else
            hp -= damage;
        if (hp = 0)
        {
            var corpse = instance_create(x, y, slimecorpse);
            corpse.image_blend = make_color_hsv(
                color_get_hue(image_blend),
                200,
                30);
            audio_play_sound(snd_dead, 10, false);
            instance_destroy();
        }
    }
}

collided =  place_meeting(x, y, opponent);

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Сначала нарисоать себя
draw_self();

//"Ядро"
draw_sprite(spr_core, 0, x + 30*offx, y - 50 + 30*offy);

//Индикация здоровья затенением
draw_sprite_ext(sprite_index, 0, x, y, image_xscale, image_yscale, image_angle, c_black, 1 - (hp+20)/70);

//Больномигалка
if (arg_hurt &gt; 0)
    draw_sprite_ext(sprite_index, 0, x, y, image_xscale, image_yscale, image_angle, c_white, arg_hurt);
    
//Глаз 
draw_sprite(spr_eye, 0, x - 30*offx, y - 50 - 30*offy);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="9" enumb="123">
      <action>
        <libid>1</libid>
        <id>331</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_restart_game</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>133,125</point>
    <point>134,134</point>
  </PhysicsShapePoints>
</object>
